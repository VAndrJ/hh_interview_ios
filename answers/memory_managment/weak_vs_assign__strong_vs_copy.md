## Weak vs assign, strong vs copy?

[**Вернутся к списку вопросов**](https://github.com/Torlopov-Andrey/hh_interview_ios/blob/master/readme.md)

##### Если коротко, то:
`weak` - это при `ARC`, `assign` - дефолтовое значение. в `non ARC`.
`Strong` - сильная ссылка. Не позволяет обнулить свойство
`Copy` - почти тоже самое что и strong, только свойство должно поддерживать протокол `NSCoping` и при присваивании свойству объекта, ему будет посылаться сообщение `copy`.

---
`copy` (соответствующая переменная должна быть с атрибутом `__strong`) — при таком значении атрибута владения в сгенерированном сеттере соответствующей переменной экземпляра присваивается значение, возвращаемое сообщением `copy`, отправленным присваиваемому объекту. Использование этого значения атрибута владения накладывает некоторые ограничения на класс объекта:

класс должен поддерживать протокол `NSCopying`,
класс не должен быть изменяемым (mutable). У некоторых классов есть mutable-подкласс, например, NSString-NSMutableString. Если ваше свойство — экземпляр «мутабельного» класса, использование `copy` приведет к нежелательным последствиям, так как метод `copy` вернет экземпляр его «немутабельного» сородича. Например, вызов `copy` у экземпляра NSMutableString вернет экземпляр `NSString`.


`weak` (соответствующая переменная должна быть с атрибутом `__weak`) — это значение аналогично `assign` и `unsafe_unretained`. Разница в том, что особая уличная магия позволяет переменным с таким значением атрибута владения менять свое значение на nil, когда объект, на который указывала переменная, уничтожается, что очень хорошо сказывается на устойчивости работы приложения (ибо, как известно, nil отвечает на любые сообщения, а значит никаких вам `EXC_BAD_ACCESS` при обращении к уже удаленному объекту). Это значение атрибута владения стоит использовать при включенном ARC для исключения retain cycle’ов для свойств, в которых хранится указатель на делегат объекта и им подобных. Это единственное значение атрибута владения, которое не поддерживается при выключенном `ARC` (как и при включенном `ARC` на iOS до версии 5.0).

`unsafe_unretained` (соответствующая переменная должна быть с атрибутом __unsafe_unretained) — свойство с таким типом владения просто сохраняет адрес присвоенного ему объекта. Методы доступа к такому свойству никак не влияют на счетчик ссылок объекта. Он может удалиться, и тогда обращение к такому свойству приведет к крэшу (потому и `unsafe`). Это значение использовалось вместо weak, когда уже появился ARC, но нужно было еще поддерживать iOS 4.3. Сейчас его использование можно оправдать разве что скоростью работы (есть сведения, что магия weak свойств требует значительного времени, хотя, конечно, невооруженным глазом при нынешней производительности этого не заметишь), поэтому, особенно на первых порах, использовать его не стоит.

`assign` (соответствующая переменная должна быть с атрибутом `__unsafe_unretained`, но так как атрибуты владения есть только у типов попадающих под ARC, с которыми лучше использовать strong или weak, это значение вам вряд ли понадобится) — просто присвоение адреса. Без ARC является дефолтным значением атрибута владения. Его стоит применять к свойствам типов, не попадающих под действие ARC (к ним относятся примитивные типы и так называемые необъектные типы (non-object types) вроде CFTypeRef). Без ARC он также используется вместо weak для исключения retain cycle’ов для свойств, в которых хранится указатель на делегат объекта и им подобных.
